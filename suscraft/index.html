<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SusCraft Legacy</title>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>

<style>
body { margin:0; background:#0b0f1a; color:white; font-family:sans-serif; overflow:hidden; }
canvas { display:block; position:fixed; inset:0; z-index:0; }
.ui { position:fixed; z-index:10; }
#menu {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(0,0,0,0.85);
  z-index: 9999; /* <- important! */
}

canvas {
  position: fixed;
  inset: 0;
  z-index: 0;       /* <- canvas behind menu */
  pointer-events: none; /* <- do not block clicks */
}
#inventory {
  position:fixed; bottom:10px; left:50%; transform:translateX(-50%);
  display:flex; gap:6px; z-index:10; visibility:hidden;
}
.slot {
  width:40px; height:40px; border:2px solid #1e293b; border-radius:10px; background:#161e2d; cursor:pointer;
}
.slot.active { border-color:#3b82f6; }
</style>
</head>
<body>

<!-- ===== MENU ===== -->
<div id="menu" class="ui">
  <button id="playBtn" class="btn">Start SusCraft</button>
</div>

<!-- Inventory -->
<div id="inventory"></div>

<script>
// =======================
// Basic Three.js Setup
// =======================
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,5,10);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// OrbitControls (mobile + desktop safe)
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.enablePan = true;
controls.enableZoom = true;

// =======================
// Lighting
// =======================
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(10,20,10);
scene.add(light);

// =======================
// Basic Block World
// =======================
const blockGeo = new THREE.BoxGeometry(1,1,1);
const blockMat = new THREE.MeshStandardMaterial({color:0x1e293b});

const worldSize = 20;
for(let x=-worldSize;x<worldSize;x++){
  for(let z=-worldSize;z<worldSize;z++){
    const cube = new THREE.Mesh(blockGeo, blockMat);
    cube.position.set(x,0,z);
    scene.add(cube);
  }
}

// =======================
// Inventory
// =======================
const inventory = document.getElementById('inventory');
for(let i=0;i<4;i++){
  const slot = document.createElement('div');
  slot.className = 'slot';
  inventory.appendChild(slot);
}

// =======================
// Player movement (WASD) & flying
// =======================
const keys = {};
document.addEventListener('keydown', e => keys[e.code] = true);
document.addEventListener('keyup', e => keys[e.code] = false);

let flySpeed = 0.2;
let flyHeight = 5;

function movePlayer(){
  if(keys.KeyW) camera.position.z -= flySpeed;
  if(keys.KeyS) camera.position.z += flySpeed;
  if(keys.KeyA) camera.position.x -= flySpeed;
  if(keys.KeyD) camera.position.x += flySpeed;
  if(keys.Space) camera.position.y += flySpeed;
  if(keys.ShiftLeft) camera.position.y -= flySpeed;
}

// =======================
// Day/Night cycle
// =======================
let sunAngle = 0;
function updateLighting(){
  sunAngle += 0.002;
  const intensity = Math.max(Math.sin(sunAngle),0.1);
  light.intensity = intensity;
  scene.background = new THREE.Color(`hsl(210,30%,${intensity*20 + 10}%)`);
}

// =======================
// Play Button
// =======================
document.getElementById('playBtn').onclick = ()=>{
  document.getElementById('menu').style.display = 'none';
  inventory.style.visibility = 'visible';
};

// =======================
// Animate Loop
// =======================
function animate(){
  requestAnimationFrame(animate);
  movePlayer();
  updateLighting();
  controls.update();
  renderer.render(scene,camera);
}
animate();

// =======================
// Handle Window Resize
// =======================
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>

</body>
</html>
